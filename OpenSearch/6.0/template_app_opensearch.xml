<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>7.0</version>
    <template_groups>
        <template_group>
            <uuid>46e77e29fa6644fea1eb2386af509d50</uuid>
            <name>TG_CLIENT_SERVER_OPENSEARCH</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>2243fd61f9a04abe99d1873dc6b04435</uuid>
            <template>OpenSearch</template>
            <name>OpenSearch</name>
            <groups>
                <group>
                    <name>TG_CLIENT_SERVER_OPENSEARCH</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>e0560ddbbdf34e04a86b00f196bea3ab</uuid>
                    <name>Disk Available</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.allocation.disk.avail</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Total disk available on the node. Not just available to OpenSearch, but the system as a whole.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.[0].['disk.avail']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_allocation</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a6aac55fd6ae4390a7827c9760053e4c</uuid>
                    <name>Disk Indices</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.allocation.disk.indices</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Size of indices currently stored on the nodes disk.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.[0].['disk.indices']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_allocation</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>beba5d4fbd3649719edb1993407c2554</uuid>
                    <name>Disk Percentage Used</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.allocation.disk.percent</key>
                    <delay>0</delay>
                    <description>Percentage of disk storage in use on node. Not just by OpenSearch.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.[0].['disk.percent']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_allocation</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>51eff34d1b704be9a9792a6cf9556319</uuid>
                    <name>Disk Used</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.allocation.disk.used</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Total disk used on server, not just by OpenSearch.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.[0].['disk.used']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_allocation</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>84c83de526c342f7a2cde3fbd98e9218</uuid>
                    <name>Shard Count</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.allocation.shards</key>
                    <delay>0</delay>
                    <description>Shard count currently stored on the node.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.[0].['shards']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_allocation</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>de6e0647c38543c08412a70e945f639e</uuid>
                    <name>OpenSearch Cat Allocation</name>
                    <type>HTTP_AGENT</type>
                    <key>opensearch.cat_allocation</key>
                    <delay>30m</delay>
                    <history>0</history>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <authtype>BASIC</authtype>
                    <username>{$OS.USERNAME}</username>
                    <password>{$OS.PASSWORD}</password>
                    <description>Gather data from the API endpoint: _cat/allocation

https://opensearch.org/docs/latest/api-reference/cat/cat-allocation/</description>
                    <url>{$OS.PROTOCOL}://{$OS.HOSTNAME}:{$OS.PORT}/_cat/allocation/{$OS.NAME}?v&amp;format=json</url>
                    <verify_peer>YES</verify_peer>
                    <verify_host>YES</verify_host>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6ac1259dabf8427c95b0e9666e2d2b99</uuid>
                    <name>OpenSearch Cat Nodes</name>
                    <type>HTTP_AGENT</type>
                    <key>opensearch.cat_nodes</key>
                    <history>0</history>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <authtype>BASIC</authtype>
                    <username>{$OS.USERNAME}</username>
                    <password>{$OS.PASSWORD}</password>
                    <description>Gather data from the API endpoint: _cat/nodes</description>
                    <url>{$OS.PROTOCOL}://{$OS.HOSTNAME}:{$OS.PORT}/_cat/nodes?h=id,pid,ip,port,http_address,version,type,build,jdk,disk.total,disk.used,disk.avail,disk.used_percent,heap.current,heap.max,heap.percent,ram.current,ram.percent,ram.max,file_desc.current,file_desc.percent,file_desc.max,cpu,load_1m,load_5m,load_15m,uptime,node.role,node.roles,cluster_manager,name,completion.size,fielddata.memory_size,fielddata.evictions,query_cache.memory_size,query_cache.evictions,query_cache.hit_count,query_cache.miss_count,request_cache.memory_size,request_cache.evictions,request_cache.hit_count,request_cache.miss_count,flush.total,flush.total_time,get.current,get.time,get.total,get.exists_time,get.exists_total,get.missing_time,get.missing_total,indexing.delete_current,indexing.delete_time,indexing.delete_total,indexing.index_current,indexing.index_time,indexing.index_total,indexing.index_failed,merges.current,merges.current_docs,merges.current_size,merges.total,merges.total_docs,merges.total_size,merges.total_time,refresh.total,refresh.time,refresh.external_total,refresh.external_time,refresh.listeners,script.compilations,script.cache_evictions,script.compilation_limit_triggered,search.fetch_current,search.fetch_time,search.fetch_total,search.open_contexts,search.query_current,search.query_time,search.query_total,search.concurrent_query_current,search.concurrent_query_time,search.concurrent_query_total,search.concurrent_avg_slice_count,search.scroll_current,search.scroll_time,search.scroll_total,search.point_in_time_current,search.point_in_time_time,search.point_in_time_total,segments.count,segments.memory,segments.index_writer_memory,segments.version_map_memory,segments.fixed_bitset_memory,suggest.current,suggest.time,suggest.total&amp;full_id&amp;format=json</url>
                    <verify_peer>YES</verify_peer>
                    <verify_host>YES</verify_host>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f97c7d8dbad44811b696ad19d298289e</uuid>
                    <name>Package Build Number</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.build</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>OpenSearch distribution package's build number.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].build</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>795a4ba9d2fe44b59511cf6735bb20ba</uuid>
                    <name>Cluster Manager</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.cluster_manager</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>True if the node is the cluster manager, False if not.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].cluster_manager</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\*</parameter>
                                <parameter>True</parameter>
                            </parameters>
                            <error_handler>CUSTOM_VALUE</error_handler>
                            <error_handler_params>False</error_handler_params>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d92b76aff7dc4214b9870984146a671e</uuid>
                    <name>Completion Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.completion.size</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Size of completion</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['completion.size']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7b458bc842fc4daf8c3ce4a8f54d69ef</uuid>
                    <name>CPU</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.cpu</key>
                    <delay>0</delay>
                    <description>Recent CPU utilization.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].cpu</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>676d3d78315e44a8afa606dc4223e8a5</uuid>
                            <expression>nodata(/OpenSearch/opensearch.node.cpu,3m)=1</expression>
                            <name>Node is not responding</name>
                            <priority>HIGH</priority>
                            <description>Attempted to reach the API on node, but hasn't been responding for at least 3 minutes.

Failing API Endpoint: {$OS.PROTOCOL}://{$OS.HOSTNAME}:{$OS.PORT}/_cat/nodes</description>
                            <tags>
                                <tag>
                                    <tag>OpenSearch</tag>
                                    <value>Health</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>89a9093d4b764c76b72b207853b9ce8c</uuid>
                    <name>Disk Available</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.disk.avail</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Total disk space available to the system.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['disk.used']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>bafdf2b42a1844069c6be4016e0b4e54</uuid>
                    <name>Disk Used</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.disk.used</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Total disk space used in OpenSearch.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['disk.used']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8b64b2a4bd9e41b5b8cf6f9c9f17d612</uuid>
                    <name>Disk Used Percent</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.disk.used_percent</key>
                    <delay>0</delay>
                    <description>Total disk space used in OpenSearch (as a percentage of total)</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['disk.used_percent']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>09e9bac897744afa9349871990ec3348</uuid>
                    <name>FieldData Evictions</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.fielddata.evictions</key>
                    <delay>0</delay>
                    <description>FieldData Evictions</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['fielddata.evictions']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>1c975791d02d4f9d850a048747e593f1</uuid>
                            <expression>last(/OpenSearch/opensearch.node.fielddata.evictions,#1)&gt;={$OS.FIELDDATA.EVICTIONS.MAX}</expression>
                            <name>OpenSearch FieldData Evictions High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's FieldData Eviction operations are higher than configured threshold.
Current FieldData Eviction operations: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.FIELDDATA.EVICTIONS.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>13bbd2dfcf2a46bc8eb3d2151e8d5003</uuid>
                    <name>FieldData Memory Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.fielddata.memory_size</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Used FieldData cache</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['fielddata.memory_size']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>cec8513ee6f64fd3bf0ce35e11022fe0</uuid>
                    <name>File Descriptors Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.file_desc.current</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Currently used file descriptors.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['file_desc.current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d2e83f8463c343d88403ce6a9d31fc86</uuid>
                    <name>File Descriptors Max</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.file_desc.max</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Maximum possible file descriptors.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['file_desc.max']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>c2577b6990eb4db287e14f1f395064ee</uuid>
                    <name>File Descriptors Percent</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.file_desc.percent</key>
                    <delay>0</delay>
                    <description>Currently used file descriptors expressed as a percentage of maximum file descriptors.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['file_desc.percent']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>1864144917a74df98a31ec4595a23ad9</uuid>
                            <expression>last(/OpenSearch/opensearch.node.file_desc.percent,#1)&gt;={$OS.FILEDESCRIPTORS.MAX}</expression>
                            <name>OpenSearch File Descriptors Availability Low</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's available file descriptors have crossed below the defined threshold.
Current descriptor utilization: {ITEM.LASTVALUE1}
Alert threshold: {$OS.FILEDESCRIPTORS.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>33de76098b9a446cb83ef3642eb81bca</uuid>
                    <name>Flush Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.flush.changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['flush.total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8a2e71e7ca9046579d486d525f369f47</uuid>
                    <name>Flush Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.flush.time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in flush</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['flush.total_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>37d5de41c2bd48aa848eb5ccee092161</uuid>
                    <name>Flush Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.flush.total</key>
                    <delay>0</delay>
                    <description>Total number of flushes.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['flush.total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>113ecfc7c83e4a9393b89d27d18c5161</uuid>
                    <name>Get Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d16d4e715afa43248d204081906196d3</uuid>
                    <name>Get Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.current</key>
                    <delay>0</delay>
                    <description>Current number of get operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>7c94857e34b244baa266af8efa3316c2</uuid>
                            <expression>last(/OpenSearch/opensearch.node.get.current,#1)&gt;={$OS.GET.CURRENT.MAX}</expression>
                            <name>OpenSearch Get Operations High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's get operations are higher than configured threshold.
Current Get operations: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.GET.CURRENT.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>85a47af065704bf995701ef768ea902d</uuid>
                    <name>Get Exists Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.exists_changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.exists_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a8c25606cb5e4c109ad689adf5f35a17</uuid>
                    <name>Get Exists Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.exists_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in successful get operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.exists_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3fbc03632e25494a9355c2e638d39e72</uuid>
                    <name>Get Exists Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.exists_total</key>
                    <delay>0</delay>
                    <description>Total number of successful get operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.exists_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>dcf93d4e7cb547408ed08ee11af212b3</uuid>
                    <name>Get Missing Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.missing_changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.missing_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>fd58aed68ca346b59a86c16be6af841f</uuid>
                    <name>Get Missing Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.missing_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in failed get operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.missing_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d083e23b68cf4d728cc0a427a65211fd</uuid>
                    <name>Get Missing Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.missing_total</key>
                    <delay>0</delay>
                    <description>Total number of failed get operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.missing_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2bbcd214551d4a66936050b016dea278</uuid>
                    <name>Get Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in get</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8f41137843f948c4a7e11939a17161a7</uuid>
                    <name>Get Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.get.total</key>
                    <delay>0</delay>
                    <description>Total number of get operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['get.total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5fa7886eed0a42e183c13c24acaa3057</uuid>
                    <name>Heap Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.heap.current</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Currently used Java heap. These are Java objects in memory.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['heap.current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>680f3771f9ea4e4d97a9ed01742f03bf</uuid>
                    <name>Heap Max</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.heap.max</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Maximum configured Java heap. These are Java objects in memory.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['heap.max']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>63324cd9fd1a45d18bed3904a651ea23</uuid>
                    <name>Heap Percent</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.heap.percent</key>
                    <delay>0</delay>
                    <description>Currently used Java heap. These are Java objects in memory. (Expressed as a percent of max)</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['heap.percent']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>a541fb644fd9437ba64100aef5aff896</uuid>
                            <expression>last(/OpenSearch/opensearch.node.heap.percent,#1)&gt;={$OS.HEAP.MAX}</expression>
                            <name>OpenSearch JVM Heap Utilization High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's JVM heap utilization is higher than configured threshold.
Current Heap Utilization: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.HEAP.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>d5a2dcddfeed4711a248ada0b2ba5dc5</uuid>
                    <name>HTTP Address</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.http_address</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>HTTP URL the node is listening on.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].http_address</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>812764a27132415780daed78aaf5abd5</uuid>
                    <name>ID</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.id</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Cluster assigned random ID</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].id</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2cec88341c7f4fb980cb3cbb113c33ee</uuid>
                    <name>Delete Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.indexing.delete_current</key>
                    <delay>0</delay>
                    <description>Current number of deletion operations on indices.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['indexing.delete_current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>3048f85f6839422ba01a325a8ae000e5</uuid>
                            <expression>last(/OpenSearch/opensearch.node.indexing.delete_current,#1)&gt;={$OS.INDEXING.DELETE.MAX}</expression>
                            <name>OpenSearch Delete Operations High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's deletion operations are higher than configured threshold.
Current Delete operations: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.INDEXING.DELETE.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>2c1471493f5746eb93c7e3c8a923ef59</uuid>
                    <name>Delete Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.indexing.delete_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in index deletion operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['indexing.delete_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>32e7f6735b9842b593d985f1410bee36</uuid>
                    <name>Indexing Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.indexing.index_current</key>
                    <delay>0</delay>
                    <description>Current number of indexing operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['indexing.index_current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>2d47c6714d384246825cd255ef4ecdf7</uuid>
                            <expression>last(/OpenSearch/opensearch.node.indexing.index_current,#1)&gt;={$OS.INDEXING.INDEX.MAX}</expression>
                            <name>OpenSearch Indexing Operations High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's indexing operations are higher than configured threshold.
Current Indexing operations: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.INDEXING.INDEX.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>882b8f1d1d134c3e823038f8e2d471b1</uuid>
                    <name>Indexing Total Failed</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.indexing.index_failed</key>
                    <delay>0</delay>
                    <description>Total number of failed indexing operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['indexing.index_failed']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e7c72866178e41118436a77c28112192</uuid>
                    <name>Indexing Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.indexing.index_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in indexing operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['indexing.index_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h)?b?/i;

var time = regex.exec(value);
var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
    return time[1] * ( Math.pow(60, multiplier ) );
}
else {
    return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>90e271084bf845c5b63d5ee954d78245</uuid>
                    <name>Indexing Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.indexing.index_total</key>
                    <delay>0</delay>
                    <description>Total number of indexing operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['indexing.index_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1486f7478e174028b2b283c2092933c1</uuid>
                    <name>IP</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.ip</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>IP the node is listening on</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].ip</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\d|\.|,)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>26ac6ce46eb7422ca338c3744600283e</uuid>
                    <name>Package JDK</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.jdk</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Node's running OpenSearch Java Development Kit (JDK) version number.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].jdk</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\d|\.)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>82e776565a4a418e81302035f218a62a</uuid>
                    <name>load_1m</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.load_1m</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <description>CPU load for the last 1 minute.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].load_1m</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>23032efb1b014625903ba9cba5e281a3</uuid>
                    <name>load_5m</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.load_5m</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <description>CPU load for the last 5 minutes.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].load_5m</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8771055e17cc44209b2a9f771c8a9596</uuid>
                    <name>load_15m</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.load_15m</key>
                    <delay>0</delay>
                    <history>1d</history>
                    <trends>0</trends>
                    <description>CPU load for the last 15 minutes.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].load_15m</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1c31b520ffec4e68a0bec40a7544d75e</uuid>
                    <name>Merges Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.merges.current</key>
                    <delay>0</delay>
                    <description>Number of current merge operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['merges.current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>350215bd180d4d86a259b4239e081b86</uuid>
                    <name>Merges Current Docs</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.merges.current_docs</key>
                    <delay>0</delay>
                    <description>Current number of merging docs operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['merges.current_docs']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>49675497141541c0940df212b0a164b3</uuid>
                    <name>Merges Current Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.merges.current_size</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Size of current merge operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['merges.current_size']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>bde0be50d7f445da83c73adead018b5c</uuid>
                    <name>Merges Total Count</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.merges.total</key>
                    <delay>0</delay>
                    <description>Total number of completed merge operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['merges.total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2204d3afdd6f466bab1e7f0524d6a36d</uuid>
                    <name>Merges Total Docs</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.merges.total_docs</key>
                    <delay>0</delay>
                    <description>Total number of completed merged documents.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['merges.total_docs']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8bd92a8276d3454484530bdc79c7407d</uuid>
                    <name>Merges Total Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.merges.total_size</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Total size of merged operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['merges.total_size']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b193fb432fc346338735120025b2be75</uuid>
                    <name>Merges Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.merges.total_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in merge operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['merges.total_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);
// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ebb0846160bb459db4f252d1babdd303</uuid>
                    <name>Name</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.name</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Admin determined node name.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['name']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7108a2adace44599b2d3271389757589</uuid>
                    <name>Node Role (Letters)</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.node.role</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Roles assigned to the node in the 'single letter form'.
m:master eligible node, d:data node, i:ingest node, -:coordinating node only, r:remote cluster client</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['node.role']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>9d7493b7deda49b9b693c60470fccab9</uuid>
                            <expression>last(/OpenSearch/opensearch.node.node.role,#2)&lt;&gt;last(/OpenSearch/opensearch.node.node.role,#1)</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>OpenSearch Node Roles Changed</name>
                            <priority>INFO</priority>
                            <description>OpenSearch node's assigned cluster roles have changed. 
New roles: {ITEM.LASTVALUE2}
Old roles: {ITEM.VALUE1}

Node Name: {$OS.NAME}</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>8fe593e508644b459667a61b61f1b85c</uuid>
                    <name>Node Roles</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.node.roles</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Roles assigned to the node.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['node.roles']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7765df434c2a4f0d827e17840bece58a</uuid>
                    <name>PID</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.pid</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Process ID of OpenSearch Service</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].pid</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\d+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0cf70c34d64b4ac69bb631d6bd551575</uuid>
                    <name>Port</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.port</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Process ID of OpenSearch Service</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].port</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\d+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>edae02dfbf8048869a80b5eab422294a</uuid>
                            <expression>last(/OpenSearch/opensearch.node.port,#2)&lt;&gt;last(/OpenSearch/opensearch.node.port,#1)</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>OpenSearch Node Port Changed</name>
                            <priority>INFO</priority>
                            <description>OpenSearch node's service port has changed:
New port: {ITEM.LASTVALUE2}
Old port: {ITEM.VALUE1}

Node Name: {$OS.NAME}</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>aaf8c06606db4efea632eb2cc59dc55c</uuid>
                    <name>Query Cache Evictions</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.query_cache.evictions</key>
                    <delay>0</delay>
                    <description>Query Cache Evictions</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['query_cache.evictions']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f64a406c54ed4f25959ab32ed2b290ae</uuid>
                    <name>Query Cache Hit Count</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.query_cache.hit_count</key>
                    <delay>0</delay>
                    <description>Query Cache Hit Count</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['query_cache.hit_count']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>1733274635484012a7ec544c1ba43448</uuid>
                    <name>Query Cache Memory Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.query_cache.memory_size</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Used Query Cache</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['query_cache.memory_size']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ca7abaeecf034a5e9be9ac948caf8778</uuid>
                    <name>Query Cache Miss Count</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.query_cache.miss_count</key>
                    <delay>0</delay>
                    <description>Query Cache Miss Count</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['query_cache.miss_count']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f7ef7516e1a64af1bb9ae6148ab17f8e</uuid>
                    <name>Ram Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.ram.current</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Currently used system memory.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['ram.current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b9d1414c7e094a38b64a5797547f4909</uuid>
                    <name>Ram Max</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.ram.max</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Total system memory.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['ram.max']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8bfa8c037a4241cd97fcd1f71fe521ca</uuid>
                    <name>Ram Percent</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.ram.percent</key>
                    <delay>0</delay>
                    <description>Currently used system memory expressed as a percentage of total system memory.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['ram.percent']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.|:)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6167f3ba6a704209b2ddf7df2c3643b2</uuid>
                    <name>Refresh Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.refresh.changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['refresh.total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0251d1c93af045208cd4a945ac53a77d</uuid>
                    <name>Refresh External Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.refresh.external_changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['refresh.external_totall']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5871d51145d940e0a80de19681f3e714</uuid>
                    <name>Refresh External Total Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.refresh.external_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in external refresh operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['refresh.external_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>cb92022cab80439ab0ee930f01128a91</uuid>
                    <name>Refresh External Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.refresh.external_total</key>
                    <delay>0</delay>
                    <description>Total number of external refreshes.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['refresh.external_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4519a6c9379641418a1bbbdd33c45928</uuid>
                    <name>Refresh Listeners</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.refresh.listeners</key>
                    <delay>0</delay>
                    <description>Total number of pending refresh listeners.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['refresh.listeners']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>21401e44234f451ab72ff74216f93a2a</uuid>
                    <name>Refresh Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.refresh.time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in refresh operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['refresh.time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>10d2a163342542ee92639b0d4a681558</uuid>
                    <name>Refresh Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.refresh.total</key>
                    <delay>0</delay>
                    <description>Total number of refresh operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['refresh.total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>bff36524fc784366a5f43e8d04a3635c</uuid>
                    <name>Request Cache Evictions</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.request_cache.evictions</key>
                    <delay>0</delay>
                    <description>Request Cache Evictions</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['request_cache.evictions']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>07c3f57e76924d45bf3b8af75c17122e</uuid>
                            <expression>last(/OpenSearch/opensearch.node.request_cache.evictions,#1)&gt;={$OS.REQUESTCACHE.EVICTIONS.MAX}</expression>
                            <name>OpenSearch Request Cache Evictions High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's Request Cache Eviction operations are higher than configured threshold.
Current Request Cache Evictions: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.REQUESTCACHE.EVICTIONS.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>fe297b48b73c4e3da5a690fa0965cd2b</uuid>
                    <name>Request Cache Hits</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.request_cache.hit_count-change</key>
                    <delay>0</delay>
                    <description>Request Cache Hits - change calculated from previous value</description>
                    <preprocessing>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.node.request_cache.hit_count-total</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7224f8ca13d04541aa01018dd4faed87</uuid>
                    <name>Request Cache Hits Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.request_cache.hit_count-total</key>
                    <delay>0</delay>
                    <description>Request Cache Hit Count</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['request_cache.hit_count']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>df7eff748d664872a10bd1fa26f33690</uuid>
                    <name>Request Cache Memory Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.request_cache.memory_size</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Used Request Cache</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['request_cache.memory_size']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>ad39f6e3b1f04b5db43e7bfa4e925e93</uuid>
                    <name>Request Cache Miss Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.request_cache.miss-total</key>
                    <delay>0</delay>
                    <description>Request Cache Miss Counter.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['request_cache.miss_count']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d87d574b998541a890f0fa5be89d2751</uuid>
                    <name>Request Cache Misses</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.request_cache.miss_count-change</key>
                    <delay>0</delay>
                    <description>Request Cache Miss Counter - calculated change since previous value.</description>
                    <preprocessing>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.node.request_cache.miss-total</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>5dae922c65094d448c9cfcc4c96a943f</uuid>
                            <expression>last(/OpenSearch/opensearch.node.request_cache.miss_count-change,#1)&gt;={$OS.REQUESTCACHE.MISSCOUNT.MAX}</expression>
                            <name>OpenSearch Request Cache Miss Count High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's request cache miss count is higher than configured threshold.
Current Request Cache Miss Count: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.REQUESTCACHE.MISSCOUNT.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>5058a156e8e64fc29e9fa2aa5352dc04</uuid>
                    <name>Cache Evictions</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.script.cache_evictions</key>
                    <delay>0</delay>
                    <description>Number of script cache evictions.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['script.cache_evictions']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>da0684491ec14fdea13ac3855303c688</uuid>
                    <name>Script Compilations</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.script.compilations</key>
                    <delay>0</delay>
                    <description>Number of script compilations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['script.compilations']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>79c29a1767c44dde9fab67df305425a0</uuid>
                    <name>Script Compilations Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.script.compilations_changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['script.compilations']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4df467ec9c01437c99c4ded7580a7cf5</uuid>
                    <name>Script Compilation Limit Triggered</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.script.compilation_limit_triggered</key>
                    <delay>0</delay>
                    <description>Number of script cache compilation limits triggered.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['script.compilation_limit_triggered']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>ad7342a6a8494f2f9e84111a1735820a</uuid>
                            <expression>last(/OpenSearch/opensearch.node.script.compilation_limit_triggered,#1)&gt;0</expression>
                            <name>OpenSearch Script Compilation Limit Reached</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch's script compilation limit was reached.

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>ff653f2a25704721951493341f27500d</uuid>
                    <name>Search Concurrent Average Slice Count</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.concurrent_avg_slice_count</key>
                    <delay>0</delay>
                    <description>Average query concurrency.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.concurrent_avg_slice_count']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>7edef1063c8543f399bb212ce001770a</uuid>
                            <expression>last(/OpenSearch/opensearch.node.search.concurrent_avg_slice_count,#1)&gt;={$OS.SEARCH.CONCURRENT_AVG_SLICE_COUNT.MAX}</expression>
                            <name>OpenSearch Concurrent Average Slices High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's concurrent average slice counter is higher than configured threshold.
Current Concurrent Average Slice counter: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.SEARCH.CONCURRENT_AVG_SLICE_COUNT.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>ce7c4799631948128cb2ce4b84bca96f</uuid>
                    <name>Search Concurrent Query Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.concurrent_query_current</key>
                    <delay>0</delay>
                    <description>Current number of concurrent query phase operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.concurrent_query_current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>7108d22bd1fb417eb8d230690092d29b</uuid>
                            <expression>last(/OpenSearch/opensearch.node.search.concurrent_query_current,#1)&gt;={$OS.SEARCH.CONCURRENT_QUERY.MAX}</expression>
                            <name>OpenSearch Concurrent Query High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's concurrent query's are higher than configured threshold.
Current Concurrent Query's: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.SEARCH.CONCURRENT_QUERY.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>bd51d33eae564f85bba266634da196af</uuid>
                    <name>Search Concurrent Query Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.concurrent_query_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in concurrent query phase.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.concurrent_query_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>cddd30cad9424645b48f4e8f33124cb8</uuid>
                    <name>Search Concurrent Query Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.concurrent_query_total</key>
                    <delay>0</delay>
                    <description>Total concurrent query phase operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.concurrent_query_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>07042912aa9449c397c4a04fbf4341d7</uuid>
                    <name>Search Fetch Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.fetch_changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.fetch_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0cf4e6f881874111b9ac1d011001d179</uuid>
                    <name>Search Fetch Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.fetch_current</key>
                    <delay>0</delay>
                    <description>Current number of fetch phase operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.fetch_current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>385f9bc74eb54f1c8a887a5abd5e4e34</uuid>
                            <expression>last(/OpenSearch/opensearch.node.search.fetch_current,#1)&gt;={$OS.SEARCH.FETCH_CURRENT.MAX}</expression>
                            <name>OpenSearch Fetch Operations High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's Fetch Phase operations are higher than configured threshold.
Current Fetch operations: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.SEARCH.FETCH_CURRENT.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>1f4d2bfcec3640bb91170adb88e418a3</uuid>
                    <name>Search Fetch Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.fetch_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in fetch phase.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.fetch_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2ccf78985f7a49769eb6c1179d68f8ad</uuid>
                    <name>Search Fetch Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.fetch_total</key>
                    <delay>0</delay>
                    <description>Total number of fetch operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.fetch_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>18f4d91e22d949739f84ec767d55f68c</uuid>
                    <name>Search Open Contexts</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.open_contexts</key>
                    <delay>0</delay>
                    <description>Number of open search contexts.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.open_contexts']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>ce790a159c9c476c9b5bccb3bbb5a281</uuid>
                            <expression>last(/OpenSearch/opensearch.node.search.open_contexts,#1)&gt;={$OS.SEARCH.OPEN_CONTEXTS.MAX}</expression>
                            <name>OpenSearch Search Open Contexts High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's open search context counter is higher than configured threshold.
Current Open Search Contexts: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.SEARCH.OPEN_CONTEXTS.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>f0eeb4b22fd24c8ba5208e9a9a831fd1</uuid>
                    <name>Search Point in Time Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.point_in_time_current</key>
                    <delay>0</delay>
                    <description>Current number of open point in time contexts.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.point_in_time_current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>adf8c161a0af4bc49353c43236bb8d42</uuid>
                    <name>Search Point in Time Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.point_in_time_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent with point in time contexts held open.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.point_in_time_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h)?b?/i;

var time = regex.exec(value);
var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
    return time[1] * ( Math.pow(60, multiplier ) );
}
else {
    return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>87d26b8220fd4cc5bfeb593b369ba8a8</uuid>
                    <name>Search Point in Time Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.point_in_time_total</key>
                    <delay>0</delay>
                    <description>Total number of completed point in time contexts.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.point_in_time_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>436f81d9bbef4c7e93fb51bc36f82667</uuid>
                    <name>Search Query Changes</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.query_changes</key>
                    <delay>0</delay>
                    <description>Zabbix calculated difference of last value and current value.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.query_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>SIMPLE_CHANGE</type>
                            <parameters>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                        <tag>
                            <tag>Source</tag>
                            <value>Calculated</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>36474ea1c04a48cd8159e2456bf5b14c</uuid>
                    <name>Query Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.query_current</key>
                    <delay>0</delay>
                    <description>Current number of query phase operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.query_current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>888d928883b5402a9a1d36832f9ccf09</uuid>
                            <expression>last(/OpenSearch/opensearch.node.search.query_current,#1)&gt;={$OS.SEARCH.QUERY.MAX}</expression>
                            <name>OpenSearch Query Operations High</name>
                            <priority>WARNING</priority>
                            <description>OpenSearch node's Search Query operations are higher than configured threshold.
Current Query operations: {ITEM.LASTVALUE1}
Alert Threshold: {$OS.SEARCH.QUERY.MAX}

Node Name: {$OS.NAME}</description>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>b2d8c7475f1f49ecb4366fd6b35ab076</uuid>
                    <name>Search Query Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.query_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in query phase.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.query_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7b2a1ff02eea4bbf98b2526b262315dc</uuid>
                    <name>Search Query Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.query_total</key>
                    <delay>0</delay>
                    <description>Total number of query phase operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.query_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>0dea30c3d27947d386d9abd237d60764</uuid>
                    <name>Search Scroll Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.scroll_current</key>
                    <delay>0</delay>
                    <description>Current number of open scroll contexts.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.scroll_current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2e7454b8230943b99f14862fb5ae7db5</uuid>
                    <name>Search Scroll Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.scroll_time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent with scroll contexts held open.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.scroll_time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>7dee3d5477cc497fa2dd4f9a54322f57</uuid>
                    <name>Search Scroll Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.search.scroll_total</key>
                    <delay>0</delay>
                    <description>Total number of completed scroll contexts</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['search.scroll_total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>539ebfc91c80480eb454da6451179496</uuid>
                    <name>Segments Count</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.segments.count</key>
                    <delay>0</delay>
                    <description>Number of segments.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['segments.count']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>5f64f17cb47d416ca9de4a376a69e62a</uuid>
                    <name>Segments Fixed Bitset Memory Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.segments.fixed_bitset_memory</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Memory used by fixed bit sets for nested object field types and type filters for types referred in _parent fields.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['segments.fixed_bitset_memory']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>954095cc1f4c4885a1a69b556f7135e5</uuid>
                    <name>Segments Index Writer Memory Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.segments.index_writer_memory</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Amount of memory used by index writer.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['segments.index_writer_memory']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>d3322e144d664b53bf566934ed578a06</uuid>
                    <name>Segments Memory Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.segments.memory</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Memory used by segments.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['segments.memory']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>4fad844e2e7746db9ea0f244f57d41a4</uuid>
                    <name>Segments Version Map Memory Size</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.segments.version_map_memory</key>
                    <delay>0</delay>
                    <units>bytes</units>
                    <description>Amount of memory used by version map.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['segments.version_map_memory']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var powers = {'b': 0, 'kb': 1, 'mb': 2, 'gb': 3, 'tb': 4};
var regex = /(\d+(?:\.\d+)?)\s?(b|kb|mb|gb|tb)?b?/i;

var res = regex.exec(value);

return res[1] * Math.pow(1024, powers[res[2].toLowerCase()]);</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a48c6504298e47f7a3f452e50d1f27f9</uuid>
                    <name>Suggest Current</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.suggest.current</key>
                    <delay>0</delay>
                    <description>Current number of suggest operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['suggest.current']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\w|\.)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>111fe26841c445c6be4885a688c44638</uuid>
                    <name>Suggest Total Time</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.suggest.time</key>
                    <delay>0</delay>
                    <units>uptime</units>
                    <description>Time spent in suggest.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['suggest.time']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>JAVASCRIPT</type>
                            <parameters>
                                <parameter>var converter = {'s': 0, 'm': 1, 'h': 2};
var regex = /(\d+(?:\.\d+)?)\s?(ms|s|m|h|d)?b?/i;

var time = regex.exec(value);

// Process days into hours
if (time[2].toLowerCase() == 'd'){
  time[1] = time[1] * 24;
  time[2] = 'h';
}

var multiplier = converter[time[2].toLowerCase()]

if (multiplier &gt; 0) {
  return time[1] * ( Math.pow(60, multiplier ) );
}
else {
  return time[1];
}</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>85546517322a40c5a17ae99231c610c6</uuid>
                    <name>Suggest Total</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.suggest.total</key>
                    <delay>0</delay>
                    <description>Total number of suggest operations.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].['suggest.total']</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>a363a3d4a93a4e118111fc63cad48289</uuid>
                    <name>Package Type</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.type</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>OpenSearch distribution package type.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].type</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>f220acb218604e8ca1ecb5153309f6fd</uuid>
                    <name>Uptime</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.uptime</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Node uptime.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].uptime</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>\w+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>b1c01c6d52a44c3ba2462b6ee5866500</uuid>
                    <name>Package Version</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.node.version</key>
                    <delay>0</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <description>Node's running OpenSearch version number.</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$[?(@.name=='{$OS.NAME}')].version</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>REGEX</type>
                            <parameters>
                                <parameter>(\d|\.)+</parameter>
                                <parameter>\0</parameter>
                            </parameters>
                        </step>
                        <step>
                            <type>DISCARD_UNCHANGED_HEARTBEAT</type>
                            <parameters>
                                <parameter>1d</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                        <tag>
                            <tag>Service</tag>
                            <value>OpenSearch</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>2debc382db374fe1b89c0d28e565a637</uuid>
                            <expression>last(/OpenSearch/opensearch.node.version,#2)&lt;&gt;last(/OpenSearch/opensearch.node.version,#1)</expression>
                            <recovery_mode>NONE</recovery_mode>
                            <name>OpenSearch Node Version Changed</name>
                            <priority>INFO</priority>
                            <description>OpenSearch node's package version has changed:
New version: {ITEM.LASTVALUE2}
Old version: {ITEM.VALUE1}

Node Name: {$OS.NAME}</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>Services</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>10e489c1f1fa484a9535466dc49ae11e</uuid>
                    <name>OpenSearch Node Stats Adaptive Selection</name>
                    <type>HTTP_AGENT</type>
                    <key>opensearch.node_stats.adaptive_selection</key>
                    <delay>5m</delay>
                    <value_type>TEXT</value_type>
                    <trends>0</trends>
                    <authtype>BASIC</authtype>
                    <username>{$OS.USERNAME}</username>
                    <password>{$OS.PASSWORD}</password>
                    <description>Gather data from the API endpoint: _nodes/stats/adaptive_selection</description>
                    <preprocessing>
                        <step>
                            <type>JSONPATH</type>
                            <parameters>
                                <parameter>$.nodes.['{$OS.ID}'].adaptive_selection</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <url>{$OS.PROTOCOL}://{$OS.HOSTNAME}:{$OS.PORT}/_nodes/_local/stats/adaptive_selection</url>
                    <verify_peer>YES</verify_peer>
                    <verify_host>YES</verify_host>
                    <tags>
                        <tag>
                            <tag>Node Name</tag>
                            <value>{$OS.NAME}</value>
                        </tag>
                    </tags>
                </item>
            </items>
            <discovery_rules>
                <discovery_rule>
                    <uuid>63f9a17511c24a3d8521b9e8008a480d</uuid>
                    <name>Node Discovery</name>
                    <type>DEPENDENT</type>
                    <key>opensearch.nodes</key>
                    <delay>0</delay>
                    <lifetime>30d</lifetime>
                    <description>Make Zabbix host aware of all other nodes for additional processing and alerts.</description>
                    <item_prototypes>
                        <item_prototype>
                            <uuid>a308214e2a11427c8dc84341e74c5f8d</uuid>
                            <name>Adaptive Selection Average Queue Size - {#NODE.NAME}</name>
                            <type>DEPENDENT</type>
                            <key>opensearch.node_stats.adaptive_selection.avg_queue_size[{#NODE.ID}]</key>
                            <delay>0</delay>
                            <description>The rolling average queue size of search requests for the node (exponentially weighted for adaptive selection rank).

Target node Name: {#NODE.NAME}
Target node ID: {#NODE.ID}
Target node IP: {#NODE.IP}

Note: Adaptive Selection will only be used if Adaptive Selection is enabled (default is enabled).</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.['{#NODE.ID}'].avg_queue_size</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>opensearch.node_stats.adaptive_selection</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>OpenSearch</tag>
                                    <value>Routing</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>769329449273467091ca5f219f368d0c</uuid>
                            <name>Adaptive Selection Average Response Time (ns) - {#NODE.NAME}</name>
                            <type>DEPENDENT</type>
                            <key>opensearch.node_stats.adaptive_selection.avg_response_time_ns[{#NODE.ID}]</key>
                            <delay>0</delay>
                            <description>The rolling average response time for search requests, in nanoseconds (exponentially weighted for adaptive selection rank).

Target node Name: {#NODE.NAME}
Target node ID: {#NODE.ID}
Target node IP: {#NODE.IP}

Note: Adaptive Selection will only be used if Adaptive Selection is enabled (default is enabled).</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.['{#NODE.ID}'].avg_response_time_ns</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>opensearch.node_stats.adaptive_selection</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>OpenSearch</tag>
                                    <value>Routing</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>3e6bc0a263154d41ac0d86d53f2a02da</uuid>
                            <name>Adaptive Selection Average Service Time (ns) - {#NODE.NAME}</name>
                            <type>DEPENDENT</type>
                            <key>opensearch.node_stats.adaptive_selection.avg_service_time_ns[{#NODE.ID}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <description>The rolling average service time for search requests, in nanoseconds (exponentially weighted for adaptive selection rank).

Target node Name: {#NODE.NAME}
Target node ID: {#NODE.ID}
Target node IP: {#NODE.IP}

Note: Adaptive Selection will only be used if Adaptive Selection is enabled (default is enabled).</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.['{#NODE.ID}'].avg_service_time_ns</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>opensearch.node_stats.adaptive_selection</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>OpenSearch</tag>
                                    <value>Routing</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>78923969b1ca4e69b5dc5f5474fac2fd</uuid>
                            <name>Adaptive Selection Outgoing Searches - {#NODE.NAME}</name>
                            <type>DEPENDENT</type>
                            <key>opensearch.node_stats.adaptive_selection.outgoing_searches[{#NODE.ID}]</key>
                            <delay>0</delay>
                            <description>Number of outgoing search requests for the node.

Target node Name: {#NODE.NAME}
Target node ID: {#NODE.ID}
Target node IP: {#NODE.IP}

Note: Adaptive Selection will only be used if Adaptive Selection is enabled (default is enabled).</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.['{#NODE.ID}'].outgoing_searches</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>opensearch.node_stats.adaptive_selection</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>OpenSearch</tag>
                                    <value>Routing</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </item_prototype>
                        <item_prototype>
                            <uuid>66b9a40dd06d4debb6cbe229bf25defa</uuid>
                            <name>Adaptive Selection Rank - {#NODE.NAME}</name>
                            <type>DEPENDENT</type>
                            <key>opensearch.node_stats.adaptive_selection.rank[{#NODE.ID}]</key>
                            <delay>0</delay>
                            <value_type>FLOAT</value_type>
                            <description>When a request goes to the node this Zabbix item is under, it will choose to route it to the node with a matching shard with the lowest rank.
Ranks are determined by the relative response time, service time, queue size, and outgoing searches.

Target node Name: {#NODE.NAME}
Target node ID: {#NODE.ID}
Target node IP: {#NODE.IP}

Note: Adaptive Selection will only be used if Adaptive Selection is enabled (default is enabled).</description>
                            <preprocessing>
                                <step>
                                    <type>JSONPATH</type>
                                    <parameters>
                                        <parameter>$.['{#NODE.ID}'].rank</parameter>
                                    </parameters>
                                </step>
                            </preprocessing>
                            <master_item>
                                <key>opensearch.node_stats.adaptive_selection</key>
                            </master_item>
                            <tags>
                                <tag>
                                    <tag>OpenSearch</tag>
                                    <value>Routing</value>
                                </tag>
                                <tag>
                                    <tag>Service</tag>
                                    <value>OpenSearch</value>
                                </tag>
                            </tags>
                        </item_prototype>
                    </item_prototypes>
                    <graph_prototypes>
                        <graph_prototype>
                            <uuid>e564f158e25c497f89ce145e0c147927</uuid>
                            <name>Adaptive Selection Rank</name>
                            <ymin_type_1>FIXED</ymin_type_1>
                            <graph_items>
                                <graph_item>
                                    <color>199C0D</color>
                                    <calc_fnc>ALL</calc_fnc>
                                    <item>
                                        <host>OpenSearch</host>
                                        <key>opensearch.node_stats.adaptive_selection.rank[{#NODE.ID}]</key>
                                    </item>
                                </graph_item>
                            </graph_items>
                        </graph_prototype>
                    </graph_prototypes>
                    <master_item>
                        <key>opensearch.cat_nodes</key>
                    </master_item>
                    <lld_macro_paths>
                        <lld_macro_path>
                            <lld_macro>{#NODE.HTTP_ADDRESS}</lld_macro>
                            <path>$.['http_address']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.ID}</lld_macro>
                            <path>$.['id']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.INSTALL.BUILD}</lld_macro>
                            <path>$.['build']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.INSTALL.TYPE}</lld_macro>
                            <path>$.['type']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.INSTALL.VERSION}</lld_macro>
                            <path>$.['version']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.IP}</lld_macro>
                            <path>$.['ip']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.NAME}</lld_macro>
                            <path>$.['name']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.PID}</lld_macro>
                            <path>$.['pid']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.PORT}</lld_macro>
                            <path>$.['port']</path>
                        </lld_macro_path>
                        <lld_macro_path>
                            <lld_macro>{#NODE.ROLES}</lld_macro>
                            <path>$.['node.role']</path>
                        </lld_macro_path>
                    </lld_macro_paths>
                </discovery_rule>
            </discovery_rules>
            <macros>
                <macro>
                    <macro>{$OS.FIELDDATA.EVICTIONS.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum FieldData eviction operations on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.FILEDESCRIPTORS.MAX}</macro>
                    <value>85</value>
                    <description>File Descriptor utilization percentage to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.GET.CURRENT.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Get operations on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.HEAP.MAX}</macro>
                    <value>85</value>
                    <description>JVM Heap utilization percentage to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.HOSTNAME}</macro>
                    <value>CHANGE_ME</value>
                    <description>Hostname of the OpenSearch cluster to make API requests to.</description>
                </macro>
                <macro>
                    <macro>{$OS.ID}</macro>
                    <value>CHANGE_ME</value>
                    <description>OpenSearch automatically assigned ID for the node.</description>
                </macro>
                <macro>
                    <macro>{$OS.INDEXING.DELETE.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Deletion operations on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.INDEXING.INDEX.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Indexing operations on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.NAME}</macro>
                    <value>CHANGE_ME</value>
                    <description>Name of node (case sensitive)</description>
                </macro>
                <macro>
                    <macro>{$OS.PASSWORD}</macro>
                    <type>SECRET_TEXT</type>
                    <description>Password to authenticate to OpenSearch with.</description>
                </macro>
                <macro>
                    <macro>{$OS.PORT}</macro>
                    <value>9200</value>
                    <description>OpenSearch port that is being listened for API requests.</description>
                </macro>
                <macro>
                    <macro>{$OS.PROTOCOL}</macro>
                    <value>https</value>
                    <description>OpenSearch protocol being used (http/https)</description>
                </macro>
                <macro>
                    <macro>{$OS.REQUESTCACHE.EVICTIONS.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Request Cache Eviction operations on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.REQUESTCACHE.MISSCOUNT.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Request Cache Miss Count on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.SEARCH.CONCURRENT_AVG_SLICE_COUNT.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Concurrent Average Slice counter on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.SEARCH.CONCURRENT_QUERY.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Search Concurrent Query operations on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.SEARCH.FETCH_CURRENT.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Fetch Phase operations on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.SEARCH.OPEN_CONTEXTS.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Open Search Contexts on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.SEARCH.QUERY.MAX}</macro>
                    <value>CUSTOMIZE</value>
                    <description>Maximum Search Query operations on node to throw alert at.</description>
                </macro>
                <macro>
                    <macro>{$OS.USERNAME}</macro>
                    <value>CHANGE_ME</value>
                    <description>Username to authenticate to OpenSearch with.</description>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <uuid>819e5323c7814fbfae3fcab307a4c933</uuid>
                    <name>OpenSearch</name>
                    <auto_start>NO</auto_start>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>graph</type>
                                    <name>Operations</name>
                                    <width>45</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Operations</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>XDESE</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>graph</type>
                                    <name>JVM Heap</name>
                                    <y>6</y>
                                    <width>27</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Heap Utilization</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>LYVAS</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>graph</type>
                                    <name>Merges Size</name>
                                    <x>27</x>
                                    <y>6</y>
                                    <width>24</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Merges Size</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>RHLUC</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>graph</type>
                                    <name>Operations Memory</name>
                                    <x>45</x>
                                    <width>27</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Services Memory</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>LXTZT</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>graph</type>
                                    <name>Merges Doc Count</name>
                                    <x>51</x>
                                    <y>6</y>
                                    <width>21</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Merges Docs</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>LSXBA</value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                        <page>
                            <name>Page 2</name>
                            <widgets>
                                <widget>
                                    <type>graph</type>
                                    <name>Query Cache Hit/Miss/Evictions</name>
                                    <width>36</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Query Cache Hit/Miss/Evictions</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>HHGGN</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>graph</type>
                                    <name>Search Metrics</name>
                                    <y>6</y>
                                    <width>36</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Search Metrics</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>BIYZI</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>graph</type>
                                    <name>Request Cache Hit/Miss/Evictions</name>
                                    <x>36</x>
                                    <width>36</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Request Cache Hit/Miss/Evictions</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>RQJAL</value>
                                        </field>
                                    </fields>
                                </widget>
                                <widget>
                                    <type>graph</type>
                                    <name>Script Compilations</name>
                                    <x>36</x>
                                    <y>6</y>
                                    <width>36</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Script Compilations</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>CJDXA</value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                        <page>
                            <name>Page 3</name>
                            <widgets>
                                <widget>
                                    <type>graph</type>
                                    <name>Search Metrics</name>
                                    <width>37</width>
                                    <height>6</height>
                                    <fields>
                                        <field>
                                            <type>INTEGER</type>
                                            <name>columns</name>
                                            <value>1</value>
                                        </field>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid.0</name>
                                            <value>
                                                <host>OpenSearch</host>
                                                <name>OpenSearch Node Search Metrics</name>
                                            </value>
                                        </field>
                                        <field>
                                            <type>STRING</type>
                                            <name>reference</name>
                                            <value>HLTVF</value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
        </template>
    </templates>
    <graphs>
        <graph>
            <uuid>32e91f6b9ac44d11b6e845b419d590d2</uuid>
            <name>OpenSearch Node Heap Utilization</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <ymax_type_1>FIXED</ymax_type_1>
            <graph_items>
                <graph_item>
                    <color>80DEEA</color>
                    <calc_fnc>MIN</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.heap.percent</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>9d620bc52fab48159121f5ee08dd3df6</uuid>
            <name>OpenSearch Node Merges Docs</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>4DD0E1</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.merges.current_docs</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>e08d69b4ee81457bb3c028110d1b0511</uuid>
            <name>OpenSearch Node Merges Size</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>4DD0E1</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.merges.current_size</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>956eaaaf80c84d2f93c8ed87b5160e4a</uuid>
            <name>OpenSearch Node Operations</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>4CAF50</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.indexing.index_current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F44336</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.indexing.delete_current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>FC6EA3</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.merges.current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>2774A4</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.get.current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>FFF59D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.fetch_current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>5</sortorder>
                    <color>C7A72D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.concurrent_query_current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>6</sortorder>
                    <color>6C59DC</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.query_current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>7</sortorder>
                    <color>BA2A5D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.suggest.current</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>b74c986950ff4fafae15f843f0ff5b26</uuid>
            <name>OpenSearch Node Query Cache Hit/Miss/Evictions</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>4CAF50</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.query_cache.hit_count</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F44336</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.query_cache.miss_count</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>FFF176</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.query_cache.evictions</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>2dc6ff70841e49be998ae1666ac37cd2</uuid>
            <name>OpenSearch Node Refreshes</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>FFF176</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.refresh.changes</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.refresh.listeners</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>c36192892f9f4f05bf1f921a1364a74f</uuid>
            <name>OpenSearch Node Request Cache Hit/Miss/Evictions</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>388E3C</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.request_cache.hit_count-total</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F44336</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.request_cache.miss-total</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>FFF176</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.request_cache.evictions</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>aa209f82f4124ec4bd8c670cd6987d03</uuid>
            <name>OpenSearch Node Script Compilations</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>F44336</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.script.compilations_changes</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>d60a7a6b69644939848e6eaa6c765133</uuid>
            <name>OpenSearch Node Search Metrics</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.concurrent_avg_slice_count</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.concurrent_query_current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>2774A4</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.fetch_changes</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>F7941D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.open_contexts</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>FC6EA3</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.point_in_time_current</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>5</sortorder>
                    <color>6C59DC</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.query_changes</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>6</sortorder>
                    <color>C7A72D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.search.scroll_current</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>3bf43d2dbef44ad88dfdbff84bdf9605</uuid>
            <name>OpenSearch Node Segment Sizes</name>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.fixed_bitset_memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>F7941D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.version_map_memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>F63100</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.index_writer_memory</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>3bf519f007af43419c5432b4d54736d0</uuid>
            <name>OpenSearch Node Services Memory</name>
            <show_triggers>NO</show_triggers>
            <ymin_type_1>FIXED</ymin_type_1>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <calc_fnc>MIN</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.fielddata.memory_size</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <calc_fnc>MIN</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.query_cache.memory_size</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>C7A72D</color>
                    <calc_fnc>MIN</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>BA2A5D</color>
                    <calc_fnc>MIN</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.version_map_memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>FC6EA3</color>
                    <calc_fnc>MIN</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.fixed_bitset_memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>5</sortorder>
                    <color>F7941D</color>
                    <calc_fnc>MIN</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.request_cache.memory_size</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>6</sortorder>
                    <color>6C59DC</color>
                    <calc_fnc>MIN</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.index_writer_memory</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
        <graph>
            <uuid>65c1932b01fe44869980a174cd7f3fe4</uuid>
            <name>OpenSearch Node Services Memory (Pie)</name>
            <yaxismax>0</yaxismax>
            <show_work_period>NO</show_work_period>
            <show_triggers>NO</show_triggers>
            <type>PIE</type>
            <graph_items>
                <graph_item>
                    <color>199C0D</color>
                    <calc_fnc>LAST</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.fielddata.memory_size</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <color>2774A4</color>
                    <calc_fnc>LAST</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.query_cache.memory_size</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>2</sortorder>
                    <color>C7A72D</color>
                    <calc_fnc>LAST</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>3</sortorder>
                    <color>BA2A5D</color>
                    <calc_fnc>LAST</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.version_map_memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>4</sortorder>
                    <color>FC6EA3</color>
                    <calc_fnc>LAST</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.fixed_bitset_memory</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>5</sortorder>
                    <color>F7941D</color>
                    <calc_fnc>LAST</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.request_cache.memory_size</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>6</sortorder>
                    <color>6C59DC</color>
                    <calc_fnc>LAST</calc_fnc>
                    <item>
                        <host>OpenSearch</host>
                        <key>opensearch.node.segments.index_writer_memory</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
